% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prediction.R
\name{predict_by_similarity}
\alias{predict_by_similarity}
\title{Predict growth media by similarity}
\usage{
predict_by_similarity(
  pathway_matrix,
  signature_matrix,
  threshold = 0.1,
  verbose = TRUE
)
}
\arguments{
\item{pathway_matrix}{Matrix of pathway expression values.}

\item{signature_matrix}{Matrix of condition-specific signature profiles.}

\item{threshold}{Numeric threshold for similarity-based predictions. Default is 0.1.}

\item{verbose}{Logical indicating whether to print progress messages. Default is TRUE.}
}
\value{
A list containing:
\itemize{
  \item similarity_matrix: Matrix of cosine similarities
  \item predicted_direct: Direct predictions (highest similarity)
  \item predicted_threshold: Threshold-based predictions
}
}
\description{
Predicts growth media conditions based on cosine similarity between pathway expression
and condition-specific signatures.
}
\details{
This function implements a similarity-based approach for predicting growth media conditions
by comparing pathway expression patterns against known signatures. It uses cosine similarity
as the metric for comparison, which measures the cosine of the angle between two vectors.

The function performs the following steps:
\enumerate{
  \item Normalizes the input pathway expression matrix to standardize values
  \item Calculates the cosine similarity between each cell's pathway expression and each condition signature
  \item Creates a similarity matrix with cells as rows and conditions as columns
  \item Makes direct predictions by selecting the condition with highest similarity for each cell
  \item Makes threshold-based predictions, returning NA if maximum similarity is below threshold
}

Cosine similarity ranges from -1 (completely opposite) to 1 (identical direction),
with 0 indicating orthogonality (no relationship). The threshold parameter allows
control over prediction stringency - higher values require stronger similarity for prediction.
}
\examples{
# Example with mock data
# Create mock pathway activity matrix
pathway_activity <- matrix(
  rnorm(150, mean = 0, sd = 1),
  nrow = 15,
  dimnames = list(
    paste0("Cell", seq_len(15)),
    paste0("Pathway", seq_len(10))
  )
)

# Create mock fingerprint profiles
# Note: fingerprints should have pathways as rows and cultures as columns
fingerprint_profiles <- matrix(
  rnorm(30, mean = 0, sd = 0.5),
  nrow = 10,
  dimnames = list(
    paste0("Pathway", seq_len(10)),
    c("CultureA", "CultureB", "CultureC")
  )
)

# Make predictions
predictions <- predict_by_similarity(
  pathway_activity,
  fingerprint_profiles
)

# Check results
print(head(predictions))
}
