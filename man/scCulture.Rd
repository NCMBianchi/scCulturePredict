% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pipeline.R
\name{scCulture}
\alias{scCulture}
\title{Single-Cell Culture Media Prediction Pipeline}
\usage{
scCulture(
  tenx_data_dir = NULL,
  sce_data_path = NULL,
  input_type,
  kegg_file = NULL,
  output_dir,
  mode = "build",
  fingerprint_file = NULL,
  experiment_id = "experiment",
  handle_duplicates = "make_unique",
  perform_tsne = TRUE,
  progress = FALSE,
  parallel = FALSE,
  n_cores = NULL,
  verbose = TRUE
)
}
\arguments{
\item{tenx_data_dir}{Character string specifying the directory containing the 10X data files.}

\item{sce_data_path}{Character string specifying the path to SingleCellExperiment RDS file or
an actual SingleCellExperiment object. Used when input_type is "sce".}

\item{input_type}{Character string specifying the input data type. Must be either "10x" for
10X Genomics data or "sce" for SingleCellExperiment data.}

\item{kegg_file}{Character string specifying the path to the KEGG pathway file.
Required for "build" mode, optional for "predict" mode if fingerprint_file contains KEGG data.}

\item{output_dir}{Character string specifying the directory for output files.}

\item{mode}{Character string specifying the analysis mode. Either "build" (generate
fingerprints from labeled data) or "predict" (apply existing fingerprints to unlabeled data).
Default is "build".}

\item{fingerprint_file}{Character string specifying the path to saved fingerprint/model file.
Required for "predict" mode, ignored in "build" mode.}

\item{experiment_id}{Character string specifying the experiment ID prefix in filenames.
Default is "experiment".}

\item{handle_duplicates}{Character string specifying how to handle duplicate gene names in SCE data.
Options are "make_unique" (default), "aggregate", "first", or "error".
"make_unique" appends .1, .2 etc to duplicates, "aggregate" sums duplicate genes,
"first" keeps only the first occurrence, "error" stops with an informative message.
Only used when input_type is "sce".}

\item{perform_tsne}{Logical indicating whether to perform t-SNE. Default is TRUE.}

\item{progress}{Logical indicating whether to show progress bar. Default is FALSE.}

\item{parallel}{Logical indicating whether to use parallel processing. Default is FALSE.}

\item{n_cores}{Integer specifying the number of cores to use for parallel processing.
Default is NULL (uses all available cores).}

\item{verbose}{Logical. Whether to print progress messages (default: TRUE).}
}
\value{
A list containing:
\itemize{
  \item seurat_object: The processed Seurat object with UMAP coordinates and predictions
  \item pathway_results: Results from KEGG pathway analysis (build mode) or fingerprint data (predict mode)
  \item prediction_results: Results from similarity and SVM prediction analysis
  \item evaluation_results: Results from prediction evaluation (build mode) or prediction confidence (predict mode)
  \item fingerprint_file: Path to saved fingerprint file (build mode only)
}
}
\description{
Runs the complete scCulturePredict analysis pipeline with two modes: "build" to generate
fingerprints from labeled training data, or "predict" to apply existing fingerprints
to new unlabeled data for cell culture media prediction.
}
\details{
The scCulture function operates in two distinct modes:

**Build Mode** (\code{mode = "build"}):
Generates transferable fingerprints from labeled training data:
\enumerate{
  \item Validates input parameters and file existence
  \item Creates output directory if it doesn't exist
  \item Loads and preprocesses labeled single-cell data
  \item Performs dimensionality reduction (PCA, UMAP, and optionally t-SNE)
  \item Parses KEGG pathways and builds transcriptomic fingerprints
  \item Trains similarity-based and SVM models
  \item Evaluates model performance with cross-validation
  \item Saves fingerprints and models for future predictions
  \item Creates publication-ready visualizations and saves results
}

**Predict Mode** (\code{mode = "predict"}):
Applies existing fingerprints to predict unlabeled data:
\enumerate{
  \item Validates input parameters and loads fingerprint file
  \item Loads and preprocesses unlabeled single-cell data
  \item Performs dimensionality reduction consistent with training data
  \item Applies pre-built fingerprints to new data
  \item Makes predictions using trained similarity and SVM models
  \item Calculates prediction confidence scores
  \item Creates prediction visualizations
}

The pipeline integrates several key analytical components:
\itemize{
  \item Data loading and preprocessing using Seurat framework
  \item Dimensionality reduction using PCA, UMAP, and optional t-SNE
  \item KEGG pathway analysis for biological interpretation
  \item Dual prediction approaches: similarity-based and machine learning (SVM)
  \item Comprehensive evaluation with statistical testing
  \item Professional visualization suite with customizable plots
}

Progress tracking options:
\itemize{
  \item \code{progress = TRUE}: Shows detailed progress bar with completion percentages
  \item \code{verbose = TRUE}: Displays step-by-step progress messages
  \item \code{parallel = TRUE}: Enables parallel processing for intensive computations
}

Output files automatically saved to \code{output_dir}:
\itemize{
  \item \code{seurat_object.rds}: Complete Seurat object with all analysis results
  \item \code{pathway_results.rds}: KEGG pathway analysis results
  \item \code{prediction_results.rds}: Similarity and SVM prediction results
  \item \code{evaluation_results.rds}: Performance evaluation metrics
  \item \code{umap_plots.pdf}: UMAP visualization plots
  \item \code{evaluation_plots.pdf}: Prediction performance plots
}
}
\examples{
\dontrun{
# Build mode - generate fingerprints from labeled training data
# Using default KEGG file
training_results <- scCulture(
  tenx_data_dir = "./DATA_labeled",
  input_type = "10x",
  output_dir = "./training_results",
  mode = "build"
)

# Or specify custom KEGG file
training_results_custom <- scCulture(
  tenx_data_dir = "./DATA_labeled",
  input_type = "10x",
  kegg_file = "custom_pathways.keg",
  output_dir = "./training_results",
  mode = "build"
)

# Access training results
fingerprint_file <- training_results$fingerprint_file
training_accuracy <- training_results$evaluation_results$overall_accuracy
}

\dontrun{
# Predict mode - apply fingerprints to new unlabeled data
prediction_results <- scCulture(
  tenx_data_dir = "./DATA_unlabeled",
  input_type = "10x",
  output_dir = "./prediction_results",
  mode = "predict",
  fingerprint_file = fingerprint_file
)

# Access predictions
predictions <- prediction_results$seurat_object$classification_pred
confidence_scores <- prediction_results$seurat_object$prediction_confidence
}

\dontrun{
# Advanced usage with progress tracking and parallel processing
# Using default KEGG file
results <- scCulture(
  tenx_data_dir = "./DATA_edit",
  input_type = "10x",
  output_dir = "./results",
  mode = "build",
  experiment_id = "my_experiment",
  progress = TRUE,
  parallel = TRUE,
  verbose = TRUE
)
}
}
\seealso{
\code{\link{load_10x_data}} for data loading
\code{\link{preprocess_data}} for data preprocessing
\code{\link{reduce_dimensions}} for dimensionality reduction
\code{\link{parse_kegg_keg}} for KEGG pathway analysis
\code{\link{predict_by_similarity}} for similarity-based prediction
\code{\link{predict_by_svm}} for SVM-based prediction
\code{\link{evaluate_predictions}} for result evaluation
\code{\link{create_evaluation_plots}} for visualization
}
