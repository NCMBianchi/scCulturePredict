% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_loading.R
\name{load_sce_data}
\alias{load_sce_data}
\title{Load SingleCellExperiment data}
\usage{
load_sce_data(
  sce_data_path,
  experiment_id,
  min_cells = 3,
  min_features = 200,
  verbose = TRUE,
  handle_duplicates = "make_unique"
)
}
\arguments{
\item{sce_data_path}{A SingleCellExperiment object or character string path to an RDS file
containing a SingleCellExperiment object.}

\item{experiment_id}{Character string specifying the experiment ID for tracking.}

\item{min_cells}{Integer specifying the minimum number of cells expressing a gene
for the gene to be included. Default is 3.}

\item{min_features}{Integer specifying the minimum number of genes expressed in a cell
for the cell to be included. Default is 200.}

\item{verbose}{Logical indicating whether to print progress messages. Default is TRUE.}

\item{handle_duplicates}{Character string specifying how to handle duplicate gene names.
Options are "make_unique" (default), "aggregate", "first", or "error".
"make_unique" appends .1, .2 etc to duplicates, "aggregate" sums duplicate genes,
"first" keeps only the first occurrence, "error" stops with an informative message.}
}
\value{
A Seurat object containing:
\itemize{
  \item Count matrix from the SingleCellExperiment
  \item Cell metadata from colData
  \item Filtered genes and cells based on \code{min_cells} and \code{min_features}
}
}
\description{
Loads single-cell data from a SingleCellExperiment object or RDS file containing one.
Converts the SingleCellExperiment to a Seurat object for pipeline compatibility.
}
\details{
The function performs the following steps:
\enumerate{
  \item Loads SCE object from file if path is provided
  \item Validates the SingleCellExperiment object structure
  \item Extracts counts and metadata
  \item Converts to Seurat object with appropriate filtering
  \item Preserves sample information from colData
}
}
\examples{
# Create a small example SingleCellExperiment
if (requireNamespace("SingleCellExperiment", quietly = TRUE)) {
  library(SingleCellExperiment)

  # Generate example count data
  set.seed(123)
  counts <- matrix(rpois(2000, lambda = 5), ncol = 40, nrow = 50)
  colnames(counts) <- paste0("Cell", seq_len(40))
  rownames(counts) <- paste0("Gene", seq_len(50))

  # Create SingleCellExperiment object
  sce <- SingleCellExperiment(assays = list(counts = counts))

  # Add sample metadata
  colData(sce)$sample <- rep(c("SampleA", "SampleB"), each = 20)

  # Load the SCE object into Seurat format
  seurat_obj <- load_sce_data(
    sce_data_path = sce,
    experiment_id = "example_sce",
    min_cells = 3,
    min_features = 10,
    verbose = FALSE
  )

  # Display basic information
  print(seurat_obj)
  cat("Number of cells:", ncol(seurat_obj), "\n")
  cat("Number of genes:", nrow(seurat_obj), "\n")
}

}
\seealso{
\code{\link{load_10x_data}} for loading 10X Genomics format data
\code{\link{preprocess_data}} for preprocessing the loaded data
}
