% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prediction.R
\name{predict_cell_types}
\alias{predict_cell_types}
\title{Predict cell types using pathway activity}
\usage{
predict_cell_types(
  seurat_object,
  pathway_activity,
  classifier,
  probability = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{seurat_object}{A Seurat object containing gene expression data.}

\item{pathway_activity}{Matrix. Pathway activity matrix where rows are pathways
and columns are cells.}

\item{classifier}{Trained classifier object. Must have a predict method.}

\item{probability}{Logical. Whether to return prediction probabilities
(default: FALSE).}

\item{verbose}{Logical. Whether to print progress messages (default: TRUE).}
}
\value{
If probability is FALSE, returns a character vector of predicted cell types.
  If probability is TRUE, returns a list containing:
  \itemize{
    \item predictions: Character vector of predicted cell types
    \item probabilities: Matrix of prediction probabilities
  }
}
\description{
Predicts cell types based on pathway activity patterns using a trained classifier.
This function takes a Seurat object and pathway activity data, and returns
predicted cell type labels for each cell.
}
\details{
This function applies a pre-trained classifier to predict cell types based on
pathway activity patterns. It's designed to work with classifiers trained using
the \code{\link{train_cell_type_classifier}} function, but can work with any
classifier that has a predict method.

The function performs several validation checks to ensure the inputs are valid:
\enumerate{
  \item Validates that seurat_object is a proper Seurat object
  \item Validates that pathway_activity is a matrix or data frame with the correct dimensions
  \item Checks that the number of cells matches between the pathway_activity and seurat_object
  \item Verifies that the classifier has a predict method
  \item Ensures all required pathways are present in the pathway_activity matrix
}

After validation, the function:
\enumerate{
  \item Extracts the relevant pathway activity patterns based on the classifier's feature importance
  \item Transposes the data to the format expected by the classifier
  \item Makes predictions using the classifier's predict method
  \item If probability=TRUE, returns both class predictions and probability estimates
  \item If probability=FALSE, returns only class predictions
}

Error handling is implemented throughout to provide informative error messages
if any step fails, making the function robust for both interactive and
programmatic use.
}
\examples{
# Example with mock data
# Create mock Seurat object
library(Seurat)
counts <- matrix(rpois(1000, 5), nrow = 100)
rownames(counts) <- paste0("Gene", seq_len(100))
colnames(counts) <- paste0("Cell", seq_len(10))
seurat_obj <- CreateSeuratObject(counts = counts)
seurat_obj <- NormalizeData(seurat_obj, verbose = FALSE)

# Create mock pathway activities
pathway_activities <- matrix(
  rnorm(50, mean = 0, sd = 1),
  nrow = 10,
  dimnames = list(
    colnames(seurat_obj),
    paste0("Pathway", seq_len(5))
  )
)

# Create mock models list
mock_fingerprints <- matrix(
  rnorm(15, mean = 0, sd = 0.5),
  nrow = 3,
  dimnames = list(
    c("TypeA", "TypeB", "TypeC"),
    paste0("Pathway", seq_len(5))
  )
)

models_list <- list(
  direct = list(fingerprints = mock_fingerprints),
  pathway_activities = pathway_activities
)

# Predict cell types
predictions <- predict_cell_types(
  seurat_obj,
  models_list,
  method = "direct"
)
}
\seealso{
\code{\link{train_cell_type_classifier}} for training the classifier
\code{\link{evaluate_predictions}} for evaluating prediction performance
}
