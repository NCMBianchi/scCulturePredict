% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_loading.R
\name{load_data}
\alias{load_data}
\title{Load single-cell data}
\usage{
load_data(
  data_dir,
  experiment_id,
  metadata_file = NULL,
  min_cells = 3,
  min_features = 200,
  verbose = TRUE
)
}
\arguments{
\item{data_dir}{Character string specifying the directory containing the data files.
The directory should contain files with the following naming pattern:
\itemize{
  \item \code{<experiment_id>_metadata.csv} - Cell metadata file
  \item \code{<experiment_id>_counts.csv} - Gene expression count matrix
}}

\item{experiment_id}{Character string specifying the experiment ID prefix in filenames.
This should match the prefix used in your data files.}

\item{metadata_file}{Optional. Character string specifying the name of the metadata file.
If NULL, will be automatically detected based on experiment_id.}

\item{min_cells}{Integer specifying the minimum number of cells expressing a gene
for the gene to be included. Default is 3.}

\item{min_features}{Integer specifying the minimum number of genes expressed in a cell
for the cell to be included. Default is 200.}

\item{verbose}{Logical indicating whether to print progress messages. Default is TRUE.}
}
\value{
A Seurat object containing:
\itemize{
  \item Count matrix in the \code{counts} slot
  \item Cell metadata in the \code{meta.data} slot
  \item Filtered genes and cells based on \code{min_cells} and \code{min_features}
}
}
\description{
Loads single-cell data from a directory containing count matrix, metadata, and barcodes.
First attempts to use the shell script for file preparation, falling back to R-based
preparation if the script fails. Automatically validates malformed input files.
}
\details{
The function performs the following steps:
\enumerate{
  \item Validates input parameters and file existence
  \item Automatically detects metadata and counts files if not specified
  \item Loads and validates metadata and counts data
  \item Checks for data consistency (matching cell numbers)
  \item Creates a Seurat object with appropriate filtering
}
}
\examples{
# Example with temporary files
# Create temporary directory and files
temp_dir <- tempdir()
exp_id <- "test_exp"

# Create mock counts file
counts_data <- matrix(rpois(500, 5), nrow = 50)
rownames(counts_data) <- paste0("Gene", seq_len(50))
colnames(counts_data) <- paste0("Cell", seq_len(10))
counts_file <- file.path(temp_dir, paste0(exp_id, "_counts.csv"))
write.csv(counts_data, counts_file)

# Create mock metadata file
metadata <- data.frame(
  cell_id = colnames(counts_data),
  sample = rep(c("Sample1", "Sample2"), each = 5)
)
metadata_file <- file.path(temp_dir, paste0(exp_id, "_metadata.csv"))
write.csv(metadata, metadata_file, row.names = FALSE)

# Load the data
seurat_obj <- load_data(
  data_dir = temp_dir,
  experiment_id = exp_id
)

# Clean up
unlink(counts_file)
unlink(metadata_file)
}
\seealso{
\code{\link{preprocess_data}} for preprocessing the loaded data
\code{\link{reduce_dimensions}} for dimensionality reduction
}
